machine:
  docker:
    version: 17.06.0-ce
  python;
    version: 2.7.3
  services:
    - docker

dependencies:
  pre:
    - pip install awscli
    - mv /home/ubuntu/alpine/docker-build /home/ubuntu/bin/docker-build
    - chmod +x /home/ubuntu/bin/docker-build
  override:
    - docker-build pull || true
    - docker-build build

test:
  override:
    - "true"

deployment:
  github_release:
    tag: /v[0-9]+(\.[0-9]+)*/
    commands:
      - docker-build push
      - docker images
  dockerhub_release:
    tag: /a[0-9]+(\.[0-9]+)*/
    commands:
      - docker-build push
      - docker images


